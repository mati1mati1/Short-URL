FROM node:20-alpine
WORKDIR /app

# Copy packages directory from root context
COPY packages ./packages

# Copy package files first
COPY services/redirect-service/package*.json ./

# Create a temporary package.json with correct path for Docker
RUN sed 's|file:../../packages/|file:./packages/|g' package.json > package.json.tmp && mv package.json.tmp package.json

# install deps
RUN npm install

# copy source
COPY services/redirect-service .

EXPOSE 3000
CMD ["npm", "run", "dev"]  
